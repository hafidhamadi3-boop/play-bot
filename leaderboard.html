<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X-Pay Leaderboard</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="languages.js"></script> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #050507; --card-bg: #16161e; --accent: #00d2ff; --gold: #ffcf4b; --silver: #c0c0c0; --bronze: #cd7f32; }
        body { background-color: var(--bg); color: white; font-family: 'Cairo', sans-serif; margin: 0; padding-bottom: 100px; overflow-x: hidden; }
        .info-bar { background: linear-gradient(to left, rgba(0, 210, 255, 0.2), transparent); margin: 15px; padding: 15px; border-radius: 20px; display: flex; justify-content: space-between; align-items: center; border-right: 4px solid var(--accent); }
        .help-btn { background: rgba(255, 255, 255, 0.1); width: 35px; height: 35px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; font-weight: bold; color: var(--accent); }
        .tabs-container { display: flex; justify-content: space-around; padding: 5px; background: var(--card-bg); margin: 10px 15px; border-radius: 15px; }
        .tab-btn { background: none; border: none; color: #888; padding: 10px 15px; font-weight: bold; font-family: 'Cairo'; flex: 1; transition: 0.3s; }
        .tab-btn.active { color: white; background: var(--accent); border-radius: 12px; box-shadow: 0 4px 10px rgba(0, 210, 255, 0.3); }
        .podium { display: flex; justify-content: center; align-items: flex-end; margin: 30px 0; gap: 10px; }
        .podium-item { text-align: center; position: relative; }
        .rank-1 { width: 100px; order: 2; transform: translateY(-15px); }
        .rank-2 { width: 85px; order: 1; }
        .rank-3 { width: 85px; order: 3; }
        .avatar-wrap { width: 100%; aspect-ratio: 1; border-radius: 50%; border: 3px solid; overflow: hidden; background: #222; margin-bottom: 10px; }
        .rank-1 .avatar-wrap { border-color: var(--gold); box-shadow: 0 0 15px var(--gold); }
        .rank-2 .avatar-wrap { border-color: var(--silver); }
        .rank-3 .avatar-wrap { border-color: var(--bronze); }
        .crown { position: absolute; top: -25px; left: 50%; transform: translateX(-50%); font-size: 20px; }
        .leaderboard-list { margin: 0 15px; background: var(--card-bg); border-radius: 20px; overflow: hidden; }
        .user-row { display: flex; align-items: center; padding: 15px; border-bottom: 1px solid rgba(255,255,255,0.05); }
        .user-row.me { background: rgba(0, 210, 255, 0.1); border-left: 3px solid var(--accent); }
        .rank-num { width: 30px; font-weight: bold; color: #888; }
        .user-info { flex: 1; margin: 0 10px; }
        .reward-val { color: var(--gold); font-weight: bold; }
        .bottom-nav { position: fixed; bottom: 0; left: 0; width: 100%; height: 80px; background: #11111a; display: flex; border-top: 1px solid rgba(0, 210, 255, 0.2); z-index: 2000; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #666; font-size: 11px; cursor: pointer; text-decoration: none; }
        .ads-btn { background: linear-gradient(45deg, #00d2ff, #9d50bb); color: white !important; margin-top: -20px; border-radius: 35px 35px 0 0; height: 100px; box-shadow: 0 -5px 20px rgba(0, 210, 255, 0.4); position: relative; }
        .timer-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); border-radius: 35px 35px 0 0; display: none; flex-direction: column; align-items: center; justify-content: center; color: #ff4757; }
    </style>
</head>
<body>

    <div class="info-bar">
        <div>
            <h3 style="margin:0;" data-i18n="top_100">Ø£Ù‚ÙˆÙ‰ 100 Ù…Ø³ØªØ«Ù…Ø± ğŸš€</h3>
            <small id="period-text" data-i18n="weekly_comp">Ø§Ù„Ù…Ù†Ø§ÙØ³Ø© Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©</small>
        </div>
        <div class="help-btn" onclick="showRules()">?</div>
    </div>

    <div class="tabs-container">
        <button class="tab-btn" onclick="updateTab(this, 'daily')" data-i18n="daily">ÙŠÙˆÙ…ÙŠ</button>
        <button class="tab-btn active" onclick="updateTab(this, 'weekly')" data-i18n="weekly">Ø£Ø³Ø¨ÙˆØ¹ÙŠ</button>
        <button class="tab-btn" onclick="updateTab(this, 'monthly')" data-i18n="monthly">Ø´Ù‡Ø±ÙŠ</button>
    </div>

    <div class="podium">
        <div class="podium-item rank-2">
            <div class="avatar-wrap"><img src="https://i.pravatar.cc/100?img=1" width="100%"></div>
            <small>Sami_DX</small>
            <div class="reward-val">25 XPC</div>
        </div>
        <div class="podium-item rank-1">
            <div class="crown">ğŸ‘‘</div>
            <div class="avatar-wrap"><img src="https://i.pravatar.cc/100?img=2" width="100%"></div>
            <b data-i18n="legend">Ø§Ù„Ø£Ø³Ø·ÙˆØ±Ø©</b>
            <div class="reward-val">50 XPC</div>
        </div>
        <div class="podium-item rank-3">
            <div class="avatar-wrap"><img src="https://i.pravatar.cc/100?img=3" width="100%"></div>
            <small>Lina_Pro</small>
            <div class="reward-val">12.5 XPC</div>
        </div>
    </div>

    <div class="leaderboard-list">
        <div class="user-row me">
            <span class="rank-num">12</span>
            <div class="user-info"><b data-i18n="you">Ø£Ù†Øª</b> (hafid)</div>
            <span class="reward-val">5 XPC</span>
        </div>
        <div class="user-row">
            <span class="rank-num">4</span>
            <div class="user-info">Ø¹Ù…Ø± Ø§Ù„Ø·Ù…ÙˆØ­</div>
            <span class="reward-val">5 XPC</span>
        </div>
    </div>

    <div class="bottom-nav">
        <a href="index.html" class="nav-item">
            <i class="fas fa-home fa-lg"></i>
            <span data-i18n="home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</span>
        </a>

        <div class="nav-item ads-btn" id="ad-btn" onclick="watchAd()">
            <div id="ad-content-normal">
                <i class="fas fa-play-circle fa-2x"></i><br>
                <span data-i18n="watch_ad">+10 Ù†Ù‚Ø§Ø·</span>
                <div style="font-size: 9px; opacity: 0.8;"><span id="ads-count">10</span>/10 <span data-i18n="remaining">Ù…ØªØ¨Ù‚ÙŠ</span></div>
            </div>
            <div class="timer-overlay" id="timer-box">
                <i class="fas fa-clock"></i>
                <b id="countdown">60:00</b>
            </div>
        </div>

        <a href="index.html#games" class="nav-item">
            <i class="fas fa-gamepad fa-lg"></i>
            <span data-i18n="play_earn">Ø¥Ù„Ø¹Ø¨ ÙˆØ§ÙƒØ³Ø¨</span>
        </a>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        let adsLeft = 10;
        let cooldownActive = false;

        // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„ØºØ© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        function applyLanguage() {
            const savedLang = localStorage.getItem('preferredLang') || 'ar';
            if (typeof translations === 'undefined') return;
            
            const data = translations[savedLang];
            document.documentElement.dir = data.dir;
            document.documentElement.lang = savedLang;

            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (data[key]) el.innerText = data[key];
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªØ¨ÙˆÙŠØ¨Ø§Øª (ÙŠÙˆÙ…ÙŠ/Ø£Ø³Ø¨ÙˆØ¹ÙŠ/Ø´Ù‡Ø±ÙŠ)
        function updateTab(btn, periodKey) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            
            const lang = localStorage.getItem('preferredLang') || 'ar';
            const periodNames = {
                daily: translations[lang].daily,
                weekly: translations[lang].weekly,
                monthly: translations[lang].monthly
            };
            
            document.getElementById('period-text').innerText = periodNames[periodKey];
            tg.HapticFeedback.impactOccurred('light');
        }

        // Ø¥Ø¸Ù‡Ø§Ø± Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„Ù…Ø³Ø§Ø¨Ù‚Ø©
        function showRules() {
            const lang = localStorage.getItem('preferredLang') || 'ar';
            const rules = {
                ar: "1. Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø£ÙˆÙ„: 50 XPC\n2. Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù†ÙŠ: 25 XPC\n3. Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø«Ø§Ù„Ø«: 12.5 XPC\nØªÙˆØ²Ø¹ Ø§Ù„Ø¬ÙˆØ§Ø¦Ø² ÙƒÙ„ ÙŠÙˆÙ… Ø£Ø­Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø© 12 Ù„ÙŠÙ„Ø§Ù‹.",
                en: "1. 1st Place: 50 XPC\n2. 2nd Place: 25 XPC\n3. 3rd Place: 12.5 XPC\nRewards distributed every Sunday at 12:00 AM."
                // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ù„ØºØ§Øª Ù‡Ù†Ø§
            };

            tg.showPopup({
                title: translations[lang].weekly_comp,
                message: rules[lang] || rules['en'],
                buttons: [{type: 'ok'}]
            });
        }

        // ÙˆØ¸ÙŠÙØ© Ù…Ø´Ø§Ù‡Ø¯Ø© Ø§Ù„Ø¥Ø¹Ù„Ø§Ù†
        function watchAd() {
            if (cooldownActive) return;
            const lang = localStorage.getItem('preferredLang') || 'ar';

            if (adsLeft > 0) {
                const confirmMsg = lang === 'ar' ? "Ø´Ø§Ù‡Ø¯ Ø¥Ø¹Ù„Ø§Ù† Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ 10 Ù†Ù‚Ø§Ø·ØŸ" : "Watch ad to get 10 points?";
                
                tg.showConfirm(confirmMsg, (confirmed) => {
                    if (confirmed) {
                        // Ù‡Ù†Ø§ ÙŠØªÙ… Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ Adsgram Ù…Ø³ØªÙ‚Ø¨Ù„Ø§Ù‹
                        adsLeft--;
                        document.getElementById('ads-count').innerText = adsLeft;
                        tg.HapticFeedback.notificationOccurred('success');
                        
                        const successMsg = lang === 'ar' ? "Ù…Ø¨Ø±ÙˆÙƒ! Ø±Ø¨Ø­Øª 10 Ù†Ù‚Ø§Ø·." : "Congrats! You earned 10 points.";
                        tg.showAlert(successMsg);
                        
                        if (adsLeft === 0) startCooldown();
                    }
                });
            }
        }

        // Ù†Ø¸Ø§Ù… Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ Ù„Ù„Ø¥Ø¹Ù„Ø§Ù†Ø§Øª
        function startCooldown() {
            cooldownActive = true;
            document.getElementById('timer-box').style.display = 'flex';
            let timeLeft = 3600; // 1 Ø³Ø§Ø¹Ø© Ø¨Ø§Ù„Ø«ÙˆØ§Ù†ÙŠ

            const interval = setInterval(() => {
                let m = Math.floor(timeLeft / 60);
                let s = timeLeft % 60;
                document.getElementById('countdown').innerText = `${m}:${s < 10 ? '0' : ''}${s}`;
                timeLeft--;

                if (timeLeft < 0) {
                    clearInterval(interval);
                    cooldownActive = false;
                    adsLeft = 10;
                    document.getElementById('timer-box').style.display = 'none';
                    document.getElementById('ads-count').innerText = adsLeft;
                }
            }, 1000);
        }

        window.onload = applyLanguage;
    </script>
</body>
</html>
